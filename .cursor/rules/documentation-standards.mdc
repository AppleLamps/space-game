---
description: "Documentation standards for code comments, README files, and API documentation"
globs: ["**/README*", "**/docs/**", "**/*.md", "**/CHANGELOG*"]
alwaysApply: false
---

# Documentation Standards

## Code Documentation Philosophy

> "Code tells you how. Comments tell you why."

### When to Comment
- **Why** decisions were made (not what the code does)
- Complex algorithms or business logic
- Non-obvious workarounds or edge cases
- TODOs with context and ticket references
- Public API documentation

### When NOT to Comment
- What the code does (make it self-documenting)
- Obvious operations
- Commented-out code (delete it, use git)
- Redundant information

## Function/Method Documentation

### TypeScript/JavaScript (JSDoc)
```typescript
/**
 * Calculates the total price including applicable discounts and taxes.
 * 
 * @param items - Cart items with price and quantity
 * @param discountCode - Optional promotional code
 * @returns Total price in cents (to avoid floating point issues)
 * @throws {InvalidDiscountError} When discount code is expired or invalid
 * 
 * @example
 * const total = calculateTotal(items, 'SAVE10');
 * // Returns: 9000 (representing $90.00)
 */
function calculateTotal(
  items: CartItem[],
  discountCode?: string
): number {
  // ...
}
```

### Python (Docstrings)
```python
def calculate_total(
    items: list[CartItem],
    discount_code: str | None = None
) -> int:
    """Calculate the total price including discounts and taxes.
    
    Args:
        items: Cart items with price and quantity.
        discount_code: Optional promotional code.
        
    Returns:
        Total price in cents (to avoid floating point issues).
        
    Raises:
        InvalidDiscountError: When discount code is expired or invalid.
        
    Example:
        >>> total = calculate_total(items, 'SAVE10')
        >>> print(total)
        9000  # Representing $90.00
    """
```

## README Structure

Every project should have a README with:

```markdown
# Project Name

Brief description (1-2 sentences) of what this project does.

## Features

- Feature 1
- Feature 2

## Quick Start

\```bash
# Installation
npm install

# Run development server
npm run dev
\```

## Prerequisites

- Node.js >= 18
- PostgreSQL 15+

## Configuration

| Variable | Description | Default |
|----------|-------------|---------|
| `DATABASE_URL` | PostgreSQL connection string | - |
| `API_KEY` | External API key | - |

## Usage

[Basic usage examples]

## API Reference

[Link to detailed API docs or inline reference]

## Development

\```bash
# Run tests
npm test

# Run linter
npm run lint
\```

## Contributing

See [CONTRIBUTING.md](CONTRIBUTING.md)

## License

[License type]
```

## API Documentation

### Endpoint Documentation
```markdown
## Create User

Creates a new user account.

**Endpoint:** `POST /api/users`

**Authentication:** Required (Bearer token)

**Request Body:**
| Field | Type | Required | Description |
|-------|------|----------|-------------|
| email | string | Yes | Valid email address |
| name | string | Yes | 1-100 characters |

**Example Request:**
\```json
{
  "email": "user@example.com",
  "name": "Jane Doe"
}
\```

**Response:** `201 Created`
\```json
{
  "id": "usr_abc123",
  "email": "user@example.com",
  "name": "Jane Doe",
  "created_at": "2024-01-15T10:30:00Z"
}
\```

**Error Responses:**
| Status | Code | Description |
|--------|------|-------------|
| 400 | `validation_error` | Invalid request body |
| 409 | `email_exists` | Email already registered |
```

## Changelog Format (Keep a Changelog)

```markdown
# Changelog

All notable changes to this project will be documented in this file.

## [Unreleased]

### Added
- New feature X

### Changed
- Updated dependency Y

## [1.2.0] - 2024-01-15

### Added
- OAuth2 authentication (#123)
- User profile editing (#124)

### Fixed
- Race condition in order processing (#125)

### Security
- Updated vulnerable dependency (#126)

## [1.1.0] - 2024-01-01
...
```

## Inline Comments Best Practices

```typescript
// ✅ Good: Explains WHY
// Using a Map instead of Object for O(1) deletion performance
// with frequent add/remove operations in real-time sync
const activeConnections = new Map<string, WebSocket>();

// ✅ Good: Documents non-obvious behavior
// API returns amounts in cents to avoid floating point errors
const priceInCents = response.amount;

// ✅ Good: TODO with context
// TODO(AUTH-456): Replace with proper JWT validation
// Temporary bypass for development - remove before production
const isAuthenticated = true;

// ❌ Bad: States the obvious
// Increment counter by 1
counter++;

// ❌ Bad: Outdated comment (code changed, comment didn't)
// Get user by email
const user = await getUserById(id);
```
